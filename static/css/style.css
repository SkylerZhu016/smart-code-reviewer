/* 通用工具类 */
.hidden {
    display: none !important;
}

/* 主题基础样式 */
body {
    font-family: "Helvetica Neue", "Arial", "PingFang SC", sans-serif;
    background-image: url('/static/images/background.webp');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    background-repeat: no-repeat;
    background-color: #F8F9FA;
    color: #212529;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
}

/* 面板基础样式 */
.panel {
    background-color: rgba(255, 255, 255, 0.85);
    border: 1px solid rgba(222, 226, 230, 0.8);
    border-radius: 4px;
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
    padding: 15px;
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    overflow: hidden;
    backdrop-filter: blur(5px);
}

/* 主容器布局 */
#app-container {
    display: flex;
    width: 100%;
    height: 100vh;
    box-sizing: border-box;
    padding: 10px;
}

/* 面板尺寸比例 */
#left-panel { flex: 0 0 250px; min-width: 200px; }
#main-panel { flex: 1 1 40%; min-width: 300px; }
#right-panel { flex: 1 1 60%; min-width: 400px; }

/* 可拖动分割线 */
.divider {
    flex: 0 0 10px;
    background-color: #F8F9FA;
    cursor: col-resize;
    display: flex;
    align-items: center;
    justify-content: center;
}
.divider::before {
    content: '';
    width: 2px;
    height: 100%;
    background-color: #DEE2E6;
    transition: background-color 0.2s;
}
.divider:hover::before {
    background-color: #007BFF;
}

/* 按钮基础样式 */
button {
    background-color: #007BFF;
    color: #FFFFFF;
    border: none;
    padding: 8px 12px;
    margin: 5px 0;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s, transform 0.1s;
}

button:hover {
    background-color: #0069D9;
}

button:active {
    transform: translateY(1px);
}

button:disabled {
    background-color: #ADB5BD;
    cursor: not-allowed;
    transform: none;
}

/* 代码编辑器区域 */
.code-area, .console-area {
    display: flex;
    flex-direction: column;
    overflow: hidden;
}
.code-area { flex: 1 1 60%; }
.console-area { flex: 1 1 40%; margin-top: 10px;}

#code-editor {
    height: 100%;
    border: 1px solid #DEE2E6;
    border-radius: 4px;
}

/* 控制台输出区域 */
.console-output {
    background-color: rgba(248, 249, 250, 0.8);
    border: 1px solid rgba(222, 226, 230, 0.8);
    border-radius: 4px;
    flex-grow: 1;
    overflow-y: auto;
}

/* 标签页样式 */
.tab-group {
    display: flex;
    margin-bottom: -1px;
    border-bottom: 1px solid #DEE2E6;
}
.tab-button { background: none; border: none; padding: 8px 15px; margin: 0; cursor: pointer; font-weight: 500; color: #6C757D; border-bottom: 2px solid transparent; transition: all 0.2s; }
.tab-button.active { color: #007BFF; border-bottom-color: #007BFF; }
.tab-button:hover:not(.active) { color: #212529; }
.tab-content { display: none; height: 100%; overflow-y: auto; padding: 10px; }
.tab-content.active { display: block; }

/* 聊天区域样式 */
#chat-area { display: flex; flex-direction: column; flex-grow: 1; overflow: hidden; margin-top: 15px; height: 100%; }
.chat-display { flex-grow: 1; overflow-y: auto; overflow-x: hidden; border: 1px solid rgba(222, 226, 230, 0.8); border-radius: 4px; padding: 15px; background-color: rgba(255, 255, 255, 0.7); display: flex; flex-direction: column; gap: 10px; min-height: 0; margin-bottom: 10px; }
.chat-message { display: flex; max-width: 85%; margin-bottom: 10px; }
.chat-message p { margin: 0; padding: 10px 15px; border-radius: 18px; line-height: 1.4; box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); word-wrap: break-word; white-space: pre-wrap; }
.user-message { align-self: flex-end; }
.user-message p { background-color: #007BFF; color: white; }
.ai-message { align-self: flex-start; }
.ai-message p { background-color: transparent; color: #212529; box-shadow: none; padding: 0; }
.ai-message .ai-message-content {
    background-color: #E9ECEF;
    color: #212529;
    padding: 10px 15px;
    border-radius: 18px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    gap: 10px;
}
.ai-message-section {
    border-left: 3px solid #007BFF;
    padding-left: 10px;
}
.ai-message-section strong {
    font-weight: 600;
    color: #007BFF;
    display: block;
    margin-bottom: 4px;
}
.ai-message-section p {
    margin: 0;
    white-space: pre-wrap;
    word-wrap: break-word;
}
.ai-message-section pre {
    background-color: rgba(0, 0, 0, 0.05);
    border-radius: 4px;
    padding: 8px;
    overflow-x: auto;
    font-size: 13px;
    margin: 0;
}
.chat-input-container { display: flex; flex-direction: column; gap: 5px; width: 100%; flex-shrink: 0; }
#main-input { resize: none; min-height: 60px; }

/* 全局加载模态框 */
#global-loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; display: flex; justify-content: center; align-items: center; }
#global-loading-modal { background-color: white; border-radius: 8px; padding: 25px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); text-align: center; max-width: 400px; width: 80%; }
.spinner { border: 4px solid #F8F9FA; border-top: 4px solid #007BFF; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 15px; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
#loading-status-text { margin-bottom: 15px; color: #212529; font-size: 16px; }
#cancel-review-btn { background-color: #DC3545; padding: 8px 15px; font-size: 14px; }
#cancel-review-btn:hover { background-color: #C82333; }

/* 测试结果样式 */
.test-case-result { padding: 10px; margin-bottom: 10px; border-radius: 4px; border-left: 4px solid; }
.test-case-result.passed { background-color: rgba(40, 167, 69, 0.1); border-left-color: #28A745; }
.test-case-result.failed { background-color: rgba(220, 53, 69, 0.1); border-left-color: #DC3545; }

/* 教师视图样式 */
.view-panel { height: 100%; display: flex; flex-direction: column; overflow-y: auto; }
#problem-form { flex-grow: 1; display: flex; flex-direction: column; }
.test-case-item { background-color: rgba(248, 249, 250, 0.8); border: 1px solid rgba(222, 226, 230, 0.8); border-radius: 4px; padding: 10px; margin-bottom: 10px; position: relative; }
.remove-test-case { background-color: #6C757D; position: absolute; top: 5px; right: 5px; padding: 2px 6px; font-size: 12px; }
.remove-test-case:hover { background-color: #DC3545; }

/* 表单样式 */
.form-group { margin-bottom: 15px; }
.form-group label { display: block; margin-bottom: 5px; font-weight: 500; color: #495057; }
textarea, input[type="text"] { width: 100%; padding: 8px 10px; border: 1px solid #CED4DA; border-radius: 4px; font-size: 14px; transition: border-color 0.2s; box-sizing: border-box; }
textarea:focus, input[type="text"]:focus { border-color: #007BFF; outline: none; box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25); }
#problem-description { flex-grow: 1; resize: vertical; }

/* 题目列表样式 */
#problem-list { list-style: none; padding: 0; margin: 0; overflow-y: auto; }
#problem-list li { padding: 12px 15px; border-bottom: 1px solid #DEE2E6; cursor: pointer; transition: background-color 0.2s; display: flex; justify-content: space-between; align-items: center;}
#problem-list li:hover { background-color: #F8F9FA; }
#problem-list li.active { background-color: #007BFF; color: white; }
.delete-problem-btn { background-color: #dc3545; color: white; border: none; padding: 4px 8px; font-size: 12px; border-radius: 4px; margin-left: 10px; }
.delete-problem-btn:hover { background-color: #c82333; }

/* 页面过渡效果 */
.screen { width: 100%; height: 100vh; box-sizing: border-box; }
#identity-selection-screen { display: flex; flex-direction: column; justify-content: center; align-items: center; }
#identity-selection-screen h1 { margin-top: 0; margin-bottom: 30px; color: #212529; }
#transition-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #F8F9FA; opacity: 0; z-index: 9999; pointer-events: none; transition: opacity 0.5s ease-in-out; }
.notification { position: fixed; top: 20px; right: 20px; padding: 15px 20px; border-radius: 5px; color: white; z-index: 1001; opacity: 1; transition: opacity 0.3s; }
.notification.info { background-color: #17a2b8; }
.notification.success { background-color: #28a745; }
.notification.error { background-color: #dc3545; }
#transition-overlay.visible { opacity: 1; pointer-events: auto; }
.panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.panel-header h3 { margin: 0; }
#code-buttons button { margin: 0 0 0 5px;}

/* 返回按钮样式 */
.back-button {
    position: fixed;
    bottom: 20px;
    left: 20px;
    background-color: rgba(108, 117, 125, 0.8);
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    display: none; /* 默认隐藏，只在主应用界面显示 */
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    z-index: 10;
    backdrop-filter: blur(5px);
}

.back-button:hover {
    background-color: rgba(220, 53, 69, 0.8);
}

.back-button::before {
    content: '';
    font-weight: normal;
}

/* 此处移除之前添加的无效样式 */

/* 原始AI响应样式 */
.ai-raw-response {
    background-color: rgba(233, 236, 239, 0.8);
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 10px;
    border-left: 4px solid #007BFF;
}

.ai-raw-response pre {
    background-color: rgba(248, 249, 250, 0.9);
    border-radius: 4px;
    padding: 10px;
    overflow-x: auto;
    font-size: 13px;
    line-height: 1.4;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/* 折叠详情样式 */
details {
    margin-top: 15px;
    border: 1px solid #DEE2E6;
    border-radius: 4px;
    padding: 10px;
    background-color: rgba(248, 249, 250, 0.5);
}

details summary {
    cursor: pointer;
    font-weight: 500;
    color: #007BFF;
    margin-bottom: 10px;
}

details summary:hover {
    color: #0069D9;
}

details pre {
    margin-top: 10px;
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 12px;
}

/* 修复AI消息内容换行问题 */
.ai-message .ai-message-content {
    background-color: #E9ECEF;
    color: #212529;
    padding: 10px 15px;
    border-radius: 18px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
    gap: 10px;
    word-wrap: break-word;      /* 确保长单词换行 */
    word-break: break-word;      /* 强制换行 */
    white-space: pre-wrap;       /* 保留换行符并允许换行 */
    max-width: 100%;             /* 防止内容溢出容器 */
    overflow-wrap: break-word;   /* 现代浏览器的换行属性 */
}

.ai-message-section {
    border-left: 3px solid #007BFF;
    padding-left: 10px;
    word-wrap: break-word;       /* 确保每个部分都能换行 */
    word-break: break-word;
    white-space: pre-wrap;
    max-width: 100%;
}

.ai-message-section strong {
    font-weight: 600;
    color: #007BFF;
    display: block;
    margin-bottom: 4px;
    word-wrap: break-word;
}

.ai-message-section p {
    margin: 0;
    white-space: pre-wrap;       /* 保留AI回复中的换行 */
    word-wrap: break-word;
    word-break: break-word;
    line-height: 1.5;            /* 增加行高提高可读性 */
}

.ai-message-section pre {
    background-color: rgba(0, 0, 0, 0.05);
    border-radius: 4px;
    padding: 8px;
    overflow-x: auto;            /* 代码块水平滚动 */
    font-size: 13px;
    margin: 0;
    white-space: pre-wrap;       /* 代码块也支持换行 */
    word-wrap: break-word;
    max-width: 100%;
}

/* 确保聊天显示区域本身也支持换行 */
.chat-display {
    flex-grow: 1;
    overflow-y: auto;
    overflow-x: hidden;
    border: 1px solid rgba(222, 226, 230, 0.8);
    border-radius: 4px;
    padding: 15px;
    background-color: rgba(255, 255, 255, 0.7);
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-height: 0;
    margin-bottom: 10px;
    word-wrap: break-word;
    word-break: break-word;
}

/* AI辅导内容样式 */
.ai-review-content {
    background-color: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    border-left: 4px solid #007bff;
    margin: 15px 0;
}

.ai-review-content p {
    margin-bottom: 15px;
    line-height: 1.6;
}

.ai-review-content strong {
    color: #007bff;
    font-weight: 600;
}

.ai-review-content pre {
    background-color: #f1f3f4;
    padding: 12px;
    border-radius: 4px;
    overflow-x: auto;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.4;
    margin: 10px 0;
}

.ai-review-content code {
    background-color: #e9ecef;
    padding: 2px 4px;
    border-radius: 3px;
    font-family: 'Courier New', monospace;
    font-size: 13px;
}

/* Markdown内容样式 */
.markdown-content {
    background-color: #ffffff;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #e9ecef;
    margin: 15px 0;
    line-height: 1.6;
    color: #333;
}

.markdown-content h1,
.markdown-content h2,
.markdown-content h3,
.markdown-content h4,
.markdown-content h5,
.markdown-content h6 {
    color: #2c3e50;
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.25;
}

.markdown-content h1 {
    font-size: 2em;
    border-bottom: 1px solid #eaecef;
    padding-bottom: 0.3em;
}

.markdown-content h2 {
    font-size: 1.5em;
    border-bottom: 1px solid #eaecef;
    padding-bottom: 0.3em;
}

.markdown-content h3 {
    font-size: 1.25em;
}

.markdown-content h4 {
    font-size: 1em;
}

.markdown-content h5 {
    font-size: 0.875em;
}

.markdown-content h6 {
    font-size: 0.85em;
    color: #6a737d;
}

.markdown-content p {
    margin-bottom: 16px;
}

.markdown-content ul,
.markdown-content ol {
    margin-bottom: 16px;
    padding-left: 2em;
}

.markdown-content li {
    margin-bottom: 4px;
}

.markdown-content blockquote {
    margin: 0 0 16px 0;
    padding: 0 1em;
    color: #6a737d;
    border-left: 0.25em solid #dfe2e5;
}

.markdown-content code {
    background-color: rgba(27, 31, 35, 0.05);
    border-radius: 3px;
    font-size: 85%;
    margin: 0;
    padding: 0.2em 0.4em;
    font-family: 'SFMono-Regular', 'Consolas', 'Liberation Mono', 'Menlo', monospace;
}

.markdown-content pre {
    background-color: #f6f8fa;
    border-radius: 6px;
    font-size: 85%;
    line-height: 1.45;
    overflow: auto;
    padding: 16px;
    margin-bottom: 16px;
}

.markdown-content pre code {
    background-color: transparent;
    border: 0;
    display: inline;
    line-height: inherit;
    margin: 0;
    max-width: auto;
    overflow: visible;
    padding: 0;
    word-wrap: normal;
}

.markdown-content table {
    border-collapse: collapse;
    margin-bottom: 16px;
    width: 100%;
}

.markdown-content table th,
.markdown-content table td {
    border: 1px solid #dfe2e5;
    padding: 6px 13px;
}

.markdown-content table th {
    background-color: #f6f8fa;
    font-weight: 600;
}

.markdown-content table tr:nth-child(2n) {
    background-color: #f6f8fa;
}

.markdown-content hr {
    border: none;
    border-top: 1px solid #eaecef;
    height: 1px;
    margin: 24px 0;
}

.markdown-content strong {
    font-weight: 600;
}

.markdown-content em {
    font-style: italic;
}

/* 教师端AI辅导专用样式 */
.ai-review-section {
    margin-bottom: 20px;
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #007bff;
}

.ai-review-section h5 {
    color: #007bff;
    font-weight: 600;
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 16px;
}

.ai-review-section p {
    margin-bottom: 0;
    line-height: 1.6;
    color: #333;
}

.ai-review-section ul {
    margin-bottom: 0;
    padding-left: 20px;
}

.ai-review-section li {
    margin-bottom: 8px;
    line-height: 1.6;
    color: #333;
}

.ai-review-section pre {
    background-color: #f1f3f4;
    padding: 12px;
    border-radius: 4px;
    overflow-x: auto;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    line-height: 1.4;
    margin: 10px 0;
    white-space: pre-wrap;
    word-wrap: break-word;
}

.ai-review-section code {
    background-color: #e9ecef;
    padding: 2px 4px;
    border-radius: 3px;
    font-family: 'Courier New', monospace;
    font-size: 13px;
}
